{% extends "layout.html" %}

{% block title %}{{ wishlist['name'] }}{% endblock %}

{% block content %}
<div class="back-button-container">
    <button class="back-button" onclick="history.back()">Back</button>
</div>

<section>
    <h3>Wishlist: {{ wishlist['name'] }}</h3>
    <div class="wishlist-grid">
        {% for item in items %}
        <div class="wishlist-item {% if item.purchased %}purchased{% endif %}">
            <div class="item-photo">
                {% if item.photo_url %}
                <img src="{{ item.photo_url }}" alt="Item Photo">
                {% else %}
                <img src="{{ url_for('static', filename='images/default.png') }}" alt="Default Item Photo">
                {% endif %}
            </div>
            <div class="item-details">
                <h4>{{ item.name }}</h4>
                <p><strong>Price:</strong> ${{ item.price }}</p>
                <p><strong>Link:</strong> <a href="{{ item.link }}" target="_blank">View Item</a></p>
                {% if item.notes %}
                <p class="item-notes">{{ item.notes }}</p>
                {% endif %}
            </div>
            <div class="item-actions">
                <a href="{{ url_for('edit_item', wishlist_id=wishlist['_id'], item_id=item['_id']) }}" class="button">Edit</a>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="actions">
        <a href="{{ url_for('add_item', wishlist_id=wishlist['_id']) }}" class="button">Add Item</a>
        <button class="button" onclick="copyWishlistLink('{{ wishlist.public_id }}')">Copy Wishlist Link</button>
    </div>
</section>

<script>
    function copyWishlistLink(publicId) {
        const baseUrl = window.location.origin;
        const link = `${baseUrl}/view/${publicId}`;

        // Copy link to clipboard
        navigator.clipboard.writeText(link).then(() => {
            alert('Wishlist link copied to clipboard: ' + link);
        }).catch(err => {
            console.error('Failed to copy link: ', err);
        });
    }
</script>
{% endblock %}
